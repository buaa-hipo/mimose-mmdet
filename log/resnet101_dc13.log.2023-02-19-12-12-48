/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
2023-02-19 12:12:53,760 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.9.16 (main, Jan 11 2023, 16:05:54) [GCC 11.2.0]
CUDA available: True
GPU 0: Tesla V100-PCIE-32GB
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 11.3, V11.3.109
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.11.0+cu113
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.12.0+cu113
OpenCV: 4.7.0
MMCV: 1.7.1
MMCV Compiler: GCC 7.5
MMCV CUDA Compiler: 11.3
MMDetection: 2.11.0+e10e3d6
------------------------------------------------------------

2023-02-19 12:12:56,387 - mmdet - INFO - Distributed training: False
2023-02-19 12:12:59,071 - mmdet - INFO - Config:
model = dict(
    type='RetinaNet',
    pretrained='torchvision://resnet101',
    backbone=dict(
        type='ResNet',
        depth=101,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=1,
        add_extra_convs='on_input',
        num_outs=5),
    bbox_head=dict(
        type='RetinaHead',
        num_classes=80,
        in_channels=256,
        stacked_convs=4,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            octave_base_scale=4,
            scales_per_octave=3,
            ratios=[0.5, 1.0, 2.0],
            strides=[8, 16, 32, 64, 128]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='FocalLoss',
            use_sigmoid=True,
            gamma=2.0,
            alpha=0.25,
            loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    train_cfg=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.4,
            min_pos_iou=0,
            ignore_iof_thr=-1),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    test_cfg=dict(
        nms_pre=1000,
        min_bbox_size=0,
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100))
dataset_type = 'CocoDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='AutoAugment',
        policies=[[{
            'type':
            'Resize',
            'img_scale': [(480, 1333), (512, 1333), (544, 1333), (576, 1333),
                          (608, 1333), (640, 1333), (672, 1333), (704, 1333),
                          (736, 1333), (768, 1333), (800, 1333)],
            'multiscale_mode':
            'value',
            'keep_ratio':
            True
        }],
                  [{
                      'type': 'Resize',
                      'img_scale': [(400, 1333), (500, 1333), (600, 1333)],
                      'multiscale_mode': 'value',
                      'keep_ratio': True
                  }, {
                      'type': 'RandomCrop',
                      'crop_type': 'absolute_range',
                      'crop_size': (384, 600),
                      'allow_negative_crop': True
                  }, {
                      'type':
                      'Resize',
                      'img_scale': [(480, 1333), (512, 1333), (544, 1333),
                                    (576, 1333), (608, 1333), (640, 1333),
                                    (672, 1333), (704, 1333), (736, 1333),
                                    (768, 1333), (800, 1333)],
                      'multiscale_mode':
                      'value',
                      'override':
                      True,
                      'keep_ratio':
                      True
                  }]]),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=6,
    workers_per_gpu=0,
    train=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_train2017.json',
        img_prefix='data/coco/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='AutoAugment',
                policies=[[{
                    'type':
                    'Resize',
                    'img_scale': [(480, 1333), (512, 1333), (544, 1333),
                                  (576, 1333), (608, 1333), (640, 1333),
                                  (672, 1333), (704, 1333), (736, 1333),
                                  (768, 1333), (800, 1333)],
                    'multiscale_mode':
                    'value',
                    'keep_ratio':
                    True
                }],
                          [{
                              'type': 'Resize',
                              'img_scale': [(400, 1333), (500, 1333),
                                            (600, 1333)],
                              'multiscale_mode': 'value',
                              'keep_ratio': True
                          }, {
                              'type': 'RandomCrop',
                              'crop_type': 'absolute_range',
                              'crop_size': (384, 600),
                              'allow_negative_crop': True
                          }, {
                              'type':
                              'Resize',
                              'img_scale': [(480, 1333), (512, 1333),
                                            (544, 1333), (576, 1333),
                                            (608, 1333), (640, 1333),
                                            (672, 1333), (704, 1333),
                                            (736, 1333), (768, 1333),
                                            (800, 1333)],
                              'multiscale_mode':
                              'value',
                              'override':
                              True,
                              'keep_ratio':
                              True
                          }]]),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_val2017.json',
        img_prefix='data/coco/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_val2017.json',
        img_prefix='data/coco/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.01, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(
    grad_clip=None,
    type='DistOptimizerHook',
    update_interval=1,
    coalesce=True,
    bucket_size_mb=-1,
    use_fp16=False,
    memory_threshold=13,
    memory_buffer=6,
    dc=dict(enable=True, warmup_iters=30))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=1)
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
fp16 = None
work_dir = './work_dirs/retinanet_r101_fpn_1x_coco_dc13'
gpu_ids = range(0, 1)

2023-02-19 12:12:59,071 - mmdet - INFO - Set random seed to 42, deterministic: False
2023-02-19 12:12:59,674 - mmdet - INFO - load model from: torchvision://resnet101
2023-02-19 12:12:59,675 - mmdet - INFO - load checkpoint from torchvision path: torchvision://resnet101
2023-02-19 12:13:00,272 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

2023-02-19 12:13:26,029 - mmdet - INFO - Start running, host: root@53f4750e67dd, work_dir: /workspace/mimose-mmdet/work_dirs/retinanet_r101_fpn_1x_coco_dc13
2023-02-19 12:13:26,029 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) EvalHook                           
(NORMAL      ) NumClassCheckHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(NORMAL      ) NumClassCheckHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2023-02-19 12:13:26,029 - mmdet - INFO - workflow: [('train', 1)], max: 1 epochs
2023-02-19 12:13:26,030 - mmdet - INFO - Checkpoints will be saved to /workspace/mimose-mmdet/work_dirs/retinanet_r101_fpn_1x_coco_dc13 by HardDiskBackend.
apex is not installed
apex is not installed
apex is not installed
apex is not installed
Seed set to 42 and deterministic=False
loading annotations into memory...
Done (t=17.11s)
creating index...
index created!
Memory threshold: 13 GiB
dc manager max memory GB: 7
loading annotations into memory...
Done (t=0.73s)
creating index...
index created!
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8339.88623046875MB
##################################### batch time #####################################
1676808808927.5107ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9218.6201171875MB
##################################### batch time #####################################
1408.6177349090576ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1184])
##################################### peak mem #####################################
8341.4453125MB
##################################### batch time #####################################
1475.5282402038574ms
##################################### input shape #####################################
torch.Size([6, 3, 1184, 768])
##################################### peak mem #####################################
8687.87548828125MB
##################################### batch time #####################################
1354.4719219207764ms
##################################### input shape #####################################
torch.Size([6, 3, 640, 832])
##################################### peak mem #####################################
5357.6416015625MB
##################################### batch time #####################################
1248.2166290283203ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 704])
##################################### peak mem #####################################
7402.17919921875MB
##################################### batch time #####################################
1057.8949451446533ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9243.49462890625MB
##################################### batch time #####################################
1491.065502166748ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 960])
##################################### peak mem #####################################
6877.37109375MB
##################################### batch time #####################################
1382.9655647277832ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9243.07568359375MB
##################################### batch time #####################################
1298.0012893676758ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9244.18017578125MB
##################################### batch time #####################################
1458.8425159454346ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8327.91796875MB
##################################### batch time #####################################
1441.781759262085ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8328.0703125MB
##################################### batch time #####################################
1398.6401557922363ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7574.1142578125MB
##################################### batch time #####################################
1271.5122699737549ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7896.541015625MB
##################################### batch time #####################################
1216.1657810211182ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8780.8310546875MB
##################################### batch time #####################################
1315.645456314087ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1024])
##################################### peak mem #####################################
7006.49658203125MB
##################################### batch time #####################################
1320.5652236938477ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 960])
##################################### peak mem #####################################
6365.0107421875MB
##################################### batch time #####################################
1205.7862281799316ms
##################################### input shape #####################################
torch.Size([6, 3, 512, 864])
##################################### peak mem #####################################
4554.359375MB
##################################### batch time #####################################
1003.6001205444336ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1152])
##################################### peak mem #####################################
9109.38671875MB
##################################### batch time #####################################
1093.3561325073242ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1088])
##################################### peak mem #####################################
8025.00927734375MB
##################################### batch time #####################################
1443.5474872589111ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9244.009765625MB
##################################### batch time #####################################
1328.324794769287ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 736])
##################################### peak mem #####################################
6472.9169921875MB
##################################### batch time #####################################
1321.3577270507812ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7927.5048828125MB
##################################### batch time #####################################
1223.2236862182617ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1152])
##################################### peak mem #####################################
8472.2705078125MB
##################################### batch time #####################################
1361.7663383483887ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 992])
##################################### peak mem #####################################
7086.94970703125MB
##################################### batch time #####################################
1299.0901470184326ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 992])
##################################### peak mem #####################################
8204.06494140625MB
##################################### batch time #####################################
1267.854928970337ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 960])
##################################### peak mem #####################################
8240.38427734375MB
##################################### batch time #####################################
1365.8089637756348ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7928.212890625MB
##################################### batch time #####################################
1310.1534843444824ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8781.17431640625MB
##################################### batch time #####################################
1365.7760620117188ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 704])
##################################### peak mem #####################################
7007.09228515625MB
##################################### batch time #####################################
1305.959939956665ms
fit memory consume
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9246.85400390625MB
##################################### batch time #####################################
1175.8058071136475ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9246.27099609375MB
##################################### batch time #####################################
1281.930923461914ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
7415.81640625MB
##################################### batch time #####################################
1161.1425876617432ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 768])
##################################### peak mem #####################################
8225.39306640625MB
##################################### batch time #####################################
1019.855260848999ms
##################################### input shape #####################################
torch.Size([6, 3, 1184, 768])
##################################### peak mem #####################################
8657.14111328125MB
##################################### batch time #####################################
1110.182523727417ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 1184])
##################################### peak mem #####################################
11989.7373046875MB
##################################### batch time #####################################
1343.904733657837ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1088])
##################################### peak mem #####################################
9241.68017578125MB
##################################### batch time #####################################
1571.8088150024414ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 928])
##################################### peak mem #####################################
7189.2353515625MB
##################################### batch time #####################################
1160.3388786315918ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.25634765625MB
##################################### batch time #####################################
1057.7778816223145ms
##################################### input shape #####################################
torch.Size([6, 3, 640, 992])
##################################### peak mem #####################################
6765.54443359375MB
##################################### batch time #####################################
1071.9797611236572ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1216])
##################################### peak mem #####################################
8537.46044921875MB
##################################### batch time #####################################
998.7187385559082ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 928])
##################################### peak mem #####################################
6669.0859375MB
##################################### batch time #####################################
1048.295259475708ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7870.98974609375MB
##################################### batch time #####################################
982.4211597442627ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 800])
##################################### peak mem #####################################
8769.16748046875MB
##################################### batch time #####################################
1149.956226348877ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7872.2392578125MB
##################################### batch time #####################################
1175.5406856536865ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7575.69873046875MB
##################################### batch time #####################################
1045.1653003692627ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1152])
##################################### peak mem #####################################
9088.8994140625MB
##################################### batch time #####################################
1069.049596786499ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 768])
##################################### peak mem #####################################
8009.955078125MB
##################################### batch time #####################################
1148.9593982696533ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
2023-02-19 12:14:30,329 - mmdet - INFO - Epoch [1][50/19545]	lr: 9.890e-04, eta: 6:57:44, time: 1.286, data_time: 0.277, memory: 7142, loss_cls: 1.1832, loss_bbox: 0.7252, loss: 1.9085
##################################### peak mem #####################################
8769.16748046875MB
##################################### batch time #####################################
1091.292142868042ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 992])
##################################### peak mem #####################################
7083.82470703125MB
##################################### batch time #####################################
1177.7074337005615ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 960])
##################################### peak mem #####################################
7147.34375MB
##################################### batch time #####################################
1083.6145877838135ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8092.49462890625MB
##################################### batch time #####################################
1115.3759956359863ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1088])
##################################### peak mem #####################################
9236.44580078125MB
##################################### batch time #####################################
1178.9965629577637ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 992])
##################################### peak mem #####################################
7078.931640625MB
##################################### batch time #####################################
1230.5355072021484ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.0322265625MB
##################################### batch time #####################################
1148.6046314239502ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.103515625MB
##################################### batch time #####################################
1182.3523044586182ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 640])
##################################### peak mem #####################################
7087.34765625MB
##################################### batch time #####################################
986.2499237060547ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7871.48095703125MB
##################################### batch time #####################################
851.84645652771ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 864])
##################################### peak mem #####################################
6956.466796875MB
##################################### batch time #####################################
994.1568374633789ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 992])
##################################### peak mem #####################################
7358.70654296875MB
##################################### batch time #####################################
1016.4029598236084ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 768])
##################################### peak mem #####################################
7146.29345703125MB
##################################### batch time #####################################
1008.6584091186523ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8546.70263671875MB
##################################### batch time #####################################
1041.5890216827393ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.8447265625MB
##################################### batch time #####################################
1256.0348510742188ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8546.49658203125MB
##################################### batch time #####################################
1378.2587051391602ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 736])
##################################### peak mem #####################################
7701.77392578125MB
##################################### batch time #####################################
1121.807336807251ms
##################################### input shape #####################################
torch.Size([6, 3, 1344, 992])
##################################### peak mem #####################################
12382.50830078125MB
##################################### batch time #####################################
1243.8631057739258ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 768])
##################################### peak mem #####################################
7576.30322265625MB
##################################### batch time #####################################
1478.4343242645264ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1344])
##################################### peak mem #####################################
8981.1298828125MB
##################################### batch time #####################################
1068.8302516937256ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.236328125MB
##################################### batch time #####################################
1222.3970890045166ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.55078125MB
##################################### batch time #####################################
1138.265609741211ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7864.7470703125MB
##################################### batch time #####################################
1137.746810913086ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.26806640625MB
##################################### batch time #####################################
1189.65482711792ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 992])
##################################### peak mem #####################################
7919.390625MB
##################################### batch time #####################################
1210.1573944091797ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9216.2490234375MB
##################################### batch time #####################################
1164.048671722412ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1120])
##################################### peak mem #####################################
8543.34423828125MB
##################################### batch time #####################################
1276.8681049346924ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 1152])
##################################### peak mem #####################################
9412.94873046875MB
##################################### batch time #####################################
1295.9022521972656ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 704])
##################################### peak mem #####################################
6955.72900390625MB
##################################### batch time #####################################
1190.624475479126ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7793.81787109375MB
##################################### batch time #####################################
907.3822498321533ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 864])
##################################### peak mem #####################################
7953.99609375MB
##################################### batch time #####################################
1047.1603870391846ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1088])
##################################### peak mem #####################################
7702.89990234375MB
##################################### batch time #####################################
1081.2036991119385ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 800])
##################################### peak mem #####################################
8766.146484375MB
##################################### batch time #####################################
1190.291166305542ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 1024])
##################################### peak mem #####################################
9304.7490234375MB
##################################### batch time #####################################
1169.4154739379883ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.24658203125MB
##################################### batch time #####################################
1212.34130859375ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1196.5951919555664ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1056])
##################################### peak mem #####################################
7198.6796875MB
##################################### batch time #####################################
1168.3998107910156ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1056])
##################################### peak mem #####################################
8980.09814453125MB
##################################### batch time #####################################
1174.3228435516357ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1024])
##################################### peak mem #####################################
7001.3310546875MB
##################################### batch time #####################################
1197.7207660675049ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 1024])
##################################### peak mem #####################################
6714.0302734375MB
##################################### batch time #####################################
963.8419151306152ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 864])
##################################### peak mem #####################################
7043.310546875MB
##################################### batch time #####################################
967.9086208343506ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 928])
##################################### peak mem #####################################
6667.74462890625MB
##################################### batch time #####################################
945.2126026153564ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.259765625MB
##################################### batch time #####################################
1011.0907554626465ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.18017578125MB
##################################### batch time #####################################
1111.6223335266113ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 960])
##################################### peak mem #####################################
7684.94384765625MB
##################################### batch time #####################################
1076.552152633667ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 928])
##################################### peak mem #####################################
7190.1982421875MB
##################################### batch time #####################################
1041.661024093628ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.31494140625MB
##################################### batch time #####################################
1085.4582786560059ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8991.76611328125MB
##################################### batch time #####################################
1260.6935501098633ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7863.43603515625MB
##################################### batch time #####################################
1169.1877841949463ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8992.107421875MB
##################################### batch time #####################################
1155.3587913513184ms
2023-02-19 12:15:27,171 - mmdet - INFO - Epoch [1][100/19545]	lr: 1.988e-03, eta: 6:32:33, time: 1.137, data_time: 0.245, memory: 7974, loss_cls: 1.1785, loss_bbox: 0.7201, loss: 1.8986
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8090.53955078125MB
##################################### batch time #####################################
1308.753490447998ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7910.02001953125MB
##################################### batch time #####################################
1125.0505447387695ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1344])
##################################### peak mem #####################################
10116.341796875MB
##################################### batch time #####################################
1175.7616996765137ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.18017578125MB
##################################### batch time #####################################
1272.3298072814941ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8543.17333984375MB
##################################### batch time #####################################
1100.0866889953613ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 896])
##################################### peak mem #####################################
6967.52001953125MB
##################################### batch time #####################################
1113.2383346557617ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 928])
##################################### peak mem #####################################
7711.919921875MB
##################################### batch time #####################################
1042.9394245147705ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 960])
##################################### peak mem #####################################
6879.48095703125MB
##################################### batch time #####################################
1069.591999053955ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 960])
##################################### peak mem #####################################
7685.0625MB
##################################### batch time #####################################
993.7489032745361ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 896])
##################################### peak mem #####################################
7220.50390625MB
##################################### batch time #####################################
1063.1084442138672ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
7413.16796875MB
##################################### batch time #####################################
1014.8694515228271ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1088])
##################################### peak mem #####################################
7703.10205078125MB
##################################### batch time #####################################
1100.679636001587ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.25537109375MB
##################################### batch time #####################################
1107.8519821166992ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1216])
##################################### peak mem #####################################
9559.22021484375MB
##################################### batch time #####################################
1144.7474956512451ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.2978515625MB
##################################### batch time #####################################
1218.104362487793ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 800])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
1084.0682983398438ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 768])
##################################### peak mem #####################################
7044.138671875MB
##################################### batch time #####################################
1097.2342491149902ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1071.8824863433838ms
##################################### input shape #####################################
torch.Size([6, 3, 1248, 800])
##################################### peak mem #####################################
9441.1845703125MB
##################################### batch time #####################################
1315.9894943237305ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8992.2021484375MB
##################################### batch time #####################################
1316.6987895965576ms
##################################### input shape #####################################
torch.Size([6, 3, 1056, 1088])
##################################### peak mem #####################################
10761.84130859375MB
##################################### batch time #####################################
1350.4040241241455ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7641.2685546875MB
##################################### batch time #####################################
1309.7507953643799ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1119.9712753295898ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.25146484375MB
##################################### batch time #####################################
1217.071294784546ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1145.4846858978271ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 768])
##################################### peak mem #####################################
7359.603515625MB
##################################### batch time #####################################
1172.1031665802002ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 928])
##################################### peak mem #####################################
9538.50244140625MB
##################################### batch time #####################################
1111.5999221801758ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
7413.89990234375MB
##################################### batch time #####################################
1243.8006401062012ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 1120])
##################################### peak mem #####################################
10427.80615234375MB
##################################### batch time #####################################
1162.243127822876ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.8310546875MB
##################################### batch time #####################################
1437.049150466919ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 864])
##################################### peak mem #####################################
7231.404296875MB
##################################### batch time #####################################
1128.1611919403076ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1162.12797164917ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1312])
##################################### peak mem #####################################
9519.59228515625MB
##################################### batch time #####################################
1258.0485343933105ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.26123046875MB
##################################### batch time #####################################
1179.9147129058838ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1088])
##################################### peak mem #####################################
8010.4765625MB
##################################### batch time #####################################
1048.9563941955566ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7864.1611328125MB
##################################### batch time #####################################
1122.363805770874ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 1024])
##################################### peak mem #####################################
11605.048828125MB
##################################### batch time #####################################
1203.641653060913ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 992])
##################################### peak mem #####################################
6804.63916015625MB
##################################### batch time #####################################
1355.93581199646ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
985.5186939239502ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1088])
##################################### peak mem #####################################
7396.97314453125MB
##################################### batch time #####################################
1111.0270023345947ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 736])
##################################### peak mem #####################################
7702.3740234375MB
##################################### batch time #####################################
1042.194128036499ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1120])
##################################### peak mem #####################################
9801.11181640625MB
##################################### batch time #####################################
1160.386562347412ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 864])
##################################### peak mem #####################################
7044.8076171875MB
##################################### batch time #####################################
1250.7753372192383ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1056])
##################################### peak mem #####################################
8981.26123046875MB
##################################### batch time #####################################
1109.5409393310547ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 704])
##################################### peak mem #####################################
6804.63916015625MB
##################################### batch time #####################################
1115.4401302337646ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1120])
##################################### peak mem #####################################
8544.5458984375MB
##################################### batch time #####################################
1172.0728874206543ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1176.6161918640137ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7794.33154296875MB
##################################### batch time #####################################
1129.3907165527344ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.81005859375MB
##################################### batch time #####################################
1166.1643981933594ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 768])
##################################### peak mem #####################################
7575.87646484375MB
2023-02-19 12:16:24,875 - mmdet - INFO - Epoch [1][150/19545]	lr: 2.987e-03, eta: 6:25:22, time: 1.154, data_time: 0.239, memory: 6773, loss_cls: 1.1797, loss_bbox: 0.7276, loss: 1.9074
##################################### batch time #####################################
1184.3595504760742ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 896])
##################################### peak mem #####################################
8476.95703125MB
##################################### batch time #####################################
1083.5487842559814ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 1024])
##################################### peak mem #####################################
6715.48974609375MB
##################################### batch time #####################################
1066.9522285461426ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 832])
##################################### peak mem #####################################
8856.33447265625MB
##################################### batch time #####################################
1080.5182456970215ms
##################################### input shape #####################################
torch.Size([6, 3, 1344, 896])
##################################### peak mem #####################################
11248.015625MB
##################################### batch time #####################################
1260.4424953460693ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1088])
##################################### peak mem #####################################
8624.16552734375MB
##################################### batch time #####################################
1402.6968479156494ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8090.4091796875MB
##################################### batch time #####################################
1156.4829349517822ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1056])
##################################### peak mem #####################################
8388.9736328125MB
##################################### batch time #####################################
1242.5391674041748ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1344])
##################################### peak mem #####################################
10117.89599609375MB
##################################### batch time #####################################
1251.7073154449463ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1056])
##################################### peak mem #####################################
7495.814453125MB
##################################### batch time #####################################
1354.677438735962ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.08642578125MB
##################################### batch time #####################################
1065.8457279205322ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7864.06201171875MB
##################################### batch time #####################################
1142.0762538909912ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 896])
##################################### peak mem #####################################
7220.50390625MB
##################################### batch time #####################################
1065.8481121063232ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 768])
##################################### peak mem #####################################
8227.33251953125MB
##################################### batch time #####################################
1024.5966911315918ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1120])
##################################### peak mem #####################################
8855.21142578125MB
##################################### batch time #####################################
1213.608741760254ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 960])
##################################### peak mem #####################################
9842.56201171875MB
##################################### batch time #####################################
1301.527976989746ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 992])
##################################### peak mem #####################################
8204.24072265625MB
##################################### batch time #####################################
1316.7874813079834ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1120])
##################################### peak mem #####################################
9800.96875MB
##################################### batch time #####################################
1156.4750671386719ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1216])
##################################### peak mem #####################################
9559.22119140625MB
##################################### batch time #####################################
1322.7968215942383ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 768])
##################################### peak mem #####################################
8439.21875MB
##################################### batch time #####################################
1339.2412662506104ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1312])
##################################### peak mem #####################################
9889.0869140625MB
##################################### batch time #####################################
1303.2374382019043ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.798828125MB
##################################### batch time #####################################
1343.1828022003174ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1024])
##################################### peak mem #####################################
7290.4560546875MB
##################################### batch time #####################################
1208.815336227417ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 864])
##################################### peak mem #####################################
8440.94677734375MB
##################################### batch time #####################################
1065.654993057251ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 800])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
1153.2297134399414ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1152])
##################################### peak mem #####################################
8439.7392578125MB
##################################### batch time #####################################
1229.4278144836426ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 704])
##################################### peak mem #####################################
7395.99609375MB
##################################### batch time #####################################
1110.410451889038ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 864])
##################################### peak mem #####################################
7470.75MB
##################################### batch time #####################################
1143.655776977539ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1344])
##################################### peak mem #####################################
9737.64111328125MB
##################################### batch time #####################################
1100.151538848877ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1216])
##################################### peak mem #####################################
10239.97021484375MB
##################################### batch time #####################################
1412.7919673919678ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 928])
##################################### peak mem #####################################
6931.69580078125MB
##################################### batch time #####################################
2043.8129901885986ms
##################################### input shape #####################################
torch.Size([6, 3, 1056, 800])
##################################### peak mem #####################################
8090.4091796875MB
##################################### batch time #####################################
1289.674997329712ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 736])
##################################### peak mem #####################################
7003.28369140625MB
##################################### batch time #####################################
1134.9658966064453ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.70458984375MB
##################################### batch time #####################################
1077.0518779754639ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.26318359375MB
##################################### batch time #####################################
1183.809518814087ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1344])
##################################### peak mem #####################################
9737.697265625MB
##################################### batch time #####################################
1302.7520179748535ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.25537109375MB
##################################### batch time #####################################
1258.4352493286133ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1312])
##################################### peak mem #####################################
9889.0869140625MB
##################################### batch time #####################################
1269.4730758666992ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 896])
##################################### peak mem #####################################
7089.9560546875MB
##################################### batch time #####################################
1263.160228729248ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.49072265625MB
##################################### batch time #####################################
1035.4149341583252ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.49072265625MB
##################################### batch time #####################################
1429.844617843628ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.08642578125MB
##################################### batch time #####################################
1603.020429611206ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8768.0732421875MB
##################################### batch time #####################################
1422.5919246673584ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 864])
##################################### peak mem #####################################
7711.34423828125MB
##################################### batch time #####################################
1215.761423110962ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1114.7727966308594ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 928])
##################################### peak mem #####################################
6931.6064453125MB
##################################### batch time #####################################
1045.8428859710693ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1164.3025875091553ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 736])
##################################### peak mem #####################################
6996.70263671875MB
##################################### batch time #####################################
1209.0458869934082ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 832])
##################################### peak mem #####################################
7221.03369140625MB
##################################### batch time #####################################
964.4365310668945ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1088])
##################################### peak mem #####################################
8624.16552734375MB
##################################### batch time #####################################
1126.5466213226318ms
##################################### input shape #####################################
2023-02-19 12:17:28,358 - mmdet - INFO - Epoch [1][200/19545]	lr: 3.986e-03, eta: 6:30:37, time: 1.270, data_time: 0.240, memory: 9280, loss_cls: 1.1692, loss_bbox: 0.7186, loss: 1.8877
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.83740234375MB
##################################### batch time #####################################
1828.8962841033936ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.818359375MB
##################################### batch time #####################################
1441.5085315704346ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9215.06982421875MB
##################################### batch time #####################################
1915.703535079956ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 736])
##################################### peak mem #####################################
7089.36767578125MB
##################################### batch time #####################################
1298.7167835235596ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 1088])
##################################### peak mem #####################################
8930.08740234375MB
##################################### batch time #####################################
991.3914203643799ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1240.7238483428955ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.94873046875MB
##################################### batch time #####################################
1224.5090007781982ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1056])
##################################### peak mem #####################################
9280.7783203125MB
##################################### batch time #####################################
1367.516279220581ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 1216])
##################################### peak mem #####################################
10923.19140625MB
##################################### batch time #####################################
1475.1040935516357ms
Traceback (most recent call last):
  File "/workspace/mimose-mmdet/tools/train.py", line 192, in <module>
    main()
  File "/workspace/mimose-mmdet/tools/train.py", line 181, in main
    train_detector(
  File "/workspace/mimose-mmdet/mmdet/apis/train.py", line 191, in train_detector
    runner.run(data_loaders, cfg.workflow)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 136, in run
    epoch_runner(data_loaders[i], **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 53, in train
    self.run_iter(data_batch, train_mode=True, **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 31, in run_iter
    outputs = self.model.train_step(data_batch, self.optimizer,
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/parallel/data_parallel.py", line 77, in train_step
    return self.module.train_step(*inputs[0], **kwargs[0])
  File "/workspace/mimose-mmdet/mmdet/models/detectors/base.py", line 251, in train_step
    losses = self(**data)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/fp16_utils.py", line 119, in new_func
    return old_func(*args, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/detectors/base.py", line 181, in forward
    return self.forward_train(img, img_metas, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/detectors/single_stage.py", line 159, in forward_train
    losses = self.bbox_head.forward_train(x, img_metas, gt_bboxes,
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/base_dense_head.py", line 54, in forward_train
    losses = self.loss(*loss_inputs, gt_bboxes_ignore=gt_bboxes_ignore)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/fp16_utils.py", line 208, in new_func
    return old_func(*args, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/anchor_head.py", line 483, in loss
    losses_cls, losses_bbox = multi_apply(
  File "/workspace/mimose-mmdet/mmdet/core/utils/misc.py", line 29, in multi_apply
    return tuple(map(list, zip(*map_results)))
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/anchor_head.py", line 406, in loss_single
    loss_cls = self.loss_cls(
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/losses/focal_loss.py", line 170, in forward
    loss_cls = self.loss_weight * calculate_loss_func(
  File "/workspace/mimose-mmdet/mmdet/models/losses/focal_loss.py", line 101, in sigmoid_focal_loss
    loss = weight_reduce_loss(loss, weight, reduction, avg_factor)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/utils/parrots_jit.py", line 22, in wrapper_inner
    return func(*args, **kargs)
  File "/workspace/mimose-mmdet/mmdet/models/losses/utils.py", line 42, in weight_reduce_loss
    loss = loss * weight
RuntimeError: CUDA out of memory. Tried to allocate 352.00 MiB (GPU 0; 31.75 GiB total capacity; 12.00 GiB already allocated; 17.44 GiB free; 13.00 GiB allowed; 12.89 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
