/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
2023-02-19 11:47:57,340 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.9.16 (main, Jan 11 2023, 16:05:54) [GCC 11.2.0]
CUDA available: True
GPU 0: Tesla V100-PCIE-32GB
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 11.3, V11.3.109
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.11.0+cu113
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.12.0+cu113
OpenCV: 4.7.0
MMCV: 1.7.1
MMCV Compiler: GCC 7.5
MMCV CUDA Compiler: 11.3
MMDetection: 2.11.0+e10e3d6
------------------------------------------------------------

2023-02-19 11:48:00,039 - mmdet - INFO - Distributed training: False
2023-02-19 11:48:02,769 - mmdet - INFO - Config:
model = dict(
    type='RetinaNet',
    pretrained='torchvision://resnet101',
    backbone=dict(
        type='ResNet',
        depth=101,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=1,
        add_extra_convs='on_input',
        num_outs=5),
    bbox_head=dict(
        type='RetinaHead',
        num_classes=80,
        in_channels=256,
        stacked_convs=4,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            octave_base_scale=4,
            scales_per_octave=3,
            ratios=[0.5, 1.0, 2.0],
            strides=[8, 16, 32, 64, 128]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='FocalLoss',
            use_sigmoid=True,
            gamma=2.0,
            alpha=0.25,
            loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    train_cfg=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.4,
            min_pos_iou=0,
            ignore_iof_thr=-1),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    test_cfg=dict(
        nms_pre=1000,
        min_bbox_size=0,
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100))
dataset_type = 'CocoDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='AutoAugment',
        policies=[[{
            'type':
            'Resize',
            'img_scale': [(480, 1333), (512, 1333), (544, 1333), (576, 1333),
                          (608, 1333), (640, 1333), (672, 1333), (704, 1333),
                          (736, 1333), (768, 1333), (800, 1333)],
            'multiscale_mode':
            'value',
            'keep_ratio':
            True
        }],
                  [{
                      'type': 'Resize',
                      'img_scale': [(400, 1333), (500, 1333), (600, 1333)],
                      'multiscale_mode': 'value',
                      'keep_ratio': True
                  }, {
                      'type': 'RandomCrop',
                      'crop_type': 'absolute_range',
                      'crop_size': (384, 600),
                      'allow_negative_crop': True
                  }, {
                      'type':
                      'Resize',
                      'img_scale': [(480, 1333), (512, 1333), (544, 1333),
                                    (576, 1333), (608, 1333), (640, 1333),
                                    (672, 1333), (704, 1333), (736, 1333),
                                    (768, 1333), (800, 1333)],
                      'multiscale_mode':
                      'value',
                      'override':
                      True,
                      'keep_ratio':
                      True
                  }]]),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=6,
    workers_per_gpu=0,
    train=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_train2017.json',
        img_prefix='data/coco/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='AutoAugment',
                policies=[[{
                    'type':
                    'Resize',
                    'img_scale': [(480, 1333), (512, 1333), (544, 1333),
                                  (576, 1333), (608, 1333), (640, 1333),
                                  (672, 1333), (704, 1333), (736, 1333),
                                  (768, 1333), (800, 1333)],
                    'multiscale_mode':
                    'value',
                    'keep_ratio':
                    True
                }],
                          [{
                              'type': 'Resize',
                              'img_scale': [(400, 1333), (500, 1333),
                                            (600, 1333)],
                              'multiscale_mode': 'value',
                              'keep_ratio': True
                          }, {
                              'type': 'RandomCrop',
                              'crop_type': 'absolute_range',
                              'crop_size': (384, 600),
                              'allow_negative_crop': True
                          }, {
                              'type':
                              'Resize',
                              'img_scale': [(480, 1333), (512, 1333),
                                            (544, 1333), (576, 1333),
                                            (608, 1333), (640, 1333),
                                            (672, 1333), (704, 1333),
                                            (736, 1333), (768, 1333),
                                            (800, 1333)],
                              'multiscale_mode':
                              'value',
                              'override':
                              True,
                              'keep_ratio':
                              True
                          }]]),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_val2017.json',
        img_prefix='data/coco/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_val2017.json',
        img_prefix='data/coco/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.01, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(
    grad_clip=None,
    type='DistOptimizerHook',
    update_interval=1,
    coalesce=True,
    bucket_size_mb=-1,
    use_fp16=False,
    memory_threshold=13,
    memory_buffer=5.5,
    dc=dict(enable=True, warmup_iters=30))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=1)
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
fp16 = None
work_dir = './work_dirs/retinanet_r101_fpn_1x_coco_dc13'
gpu_ids = range(0, 1)

2023-02-19 11:48:02,770 - mmdet - INFO - Set random seed to 42, deterministic: False
2023-02-19 11:48:03,372 - mmdet - INFO - load model from: torchvision://resnet101
2023-02-19 11:48:03,373 - mmdet - INFO - load checkpoint from torchvision path: torchvision://resnet101
2023-02-19 11:48:03,970 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

2023-02-19 11:48:29,209 - mmdet - INFO - Start running, host: root@53f4750e67dd, work_dir: /workspace/mimose-mmdet/work_dirs/retinanet_r101_fpn_1x_coco_dc13
2023-02-19 11:48:29,210 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) EvalHook                           
(NORMAL      ) NumClassCheckHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(NORMAL      ) NumClassCheckHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2023-02-19 11:48:29,210 - mmdet - INFO - workflow: [('train', 1)], max: 1 epochs
2023-02-19 11:48:29,211 - mmdet - INFO - Checkpoints will be saved to /workspace/mimose-mmdet/work_dirs/retinanet_r101_fpn_1x_coco_dc13 by HardDiskBackend.
apex is not installed
apex is not installed
apex is not installed
apex is not installed
Seed set to 42 and deterministic=False
loading annotations into memory...
Done (t=16.86s)
creating index...
index created!
Memory threshold: 13 GiB
dc manager max memory GB: 7.5
loading annotations into memory...
Done (t=0.51s)
creating index...
index created!
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8339.88623046875MB
##################################### batch time #####################################
1676807312076.548ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9218.6201171875MB
##################################### batch time #####################################
1423.8383769989014ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1184])
##################################### peak mem #####################################
8341.4453125MB
##################################### batch time #####################################
1466.404676437378ms
##################################### input shape #####################################
torch.Size([6, 3, 1184, 768])
##################################### peak mem #####################################
8687.87548828125MB
##################################### batch time #####################################
1419.461727142334ms
##################################### input shape #####################################
torch.Size([6, 3, 640, 832])
##################################### peak mem #####################################
5357.6416015625MB
##################################### batch time #####################################
1253.5743713378906ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 704])
##################################### peak mem #####################################
7402.17919921875MB
##################################### batch time #####################################
1035.444736480713ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9243.49462890625MB
##################################### batch time #####################################
1403.0334949493408ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 960])
##################################### peak mem #####################################
6877.37109375MB
##################################### batch time #####################################
1348.2873439788818ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9243.07568359375MB
##################################### batch time #####################################
1311.373233795166ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9244.18017578125MB
##################################### batch time #####################################
1468.7764644622803ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8327.91796875MB
##################################### batch time #####################################
1431.509017944336ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8328.0703125MB
##################################### batch time #####################################
1398.8380432128906ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7574.1142578125MB
##################################### batch time #####################################
1314.436912536621ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7896.541015625MB
##################################### batch time #####################################
1271.2442874908447ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8780.8310546875MB
##################################### batch time #####################################
1301.851511001587ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1024])
##################################### peak mem #####################################
7006.49658203125MB
##################################### batch time #####################################
1331.7158222198486ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 960])
##################################### peak mem #####################################
6365.0107421875MB
##################################### batch time #####################################
1184.1182708740234ms
##################################### input shape #####################################
torch.Size([6, 3, 512, 864])
##################################### peak mem #####################################
4554.359375MB
##################################### batch time #####################################
1000.2882480621338ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1152])
##################################### peak mem #####################################
9109.38671875MB
##################################### batch time #####################################
1149.3277549743652ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1088])
##################################### peak mem #####################################
8025.00927734375MB
##################################### batch time #####################################
1441.2057399749756ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9244.009765625MB
##################################### batch time #####################################
1336.8864059448242ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 736])
##################################### peak mem #####################################
6472.9169921875MB
##################################### batch time #####################################
1341.1917686462402ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7927.5048828125MB
##################################### batch time #####################################
1185.396432876587ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1152])
##################################### peak mem #####################################
8472.2705078125MB
##################################### batch time #####################################
1415.5645370483398ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 992])
##################################### peak mem #####################################
7086.94970703125MB
##################################### batch time #####################################
1281.8055152893066ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 992])
##################################### peak mem #####################################
8204.06494140625MB
##################################### batch time #####################################
1246.577262878418ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 960])
##################################### peak mem #####################################
8240.38427734375MB
##################################### batch time #####################################
1302.260160446167ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7928.212890625MB
##################################### batch time #####################################
1349.3216037750244ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8781.17431640625MB
##################################### batch time #####################################
1352.6103496551514ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 704])
##################################### peak mem #####################################
7007.09228515625MB
##################################### batch time #####################################
1300.0364303588867ms
fit memory consume
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9246.85400390625MB
##################################### batch time #####################################
1147.4595069885254ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9246.27099609375MB
##################################### batch time #####################################
1269.5074081420898ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
7415.81640625MB
##################################### batch time #####################################
1155.5516719818115ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 768])
##################################### peak mem #####################################
8225.39306640625MB
##################################### batch time #####################################
1029.4275283813477ms
##################################### input shape #####################################
torch.Size([6, 3, 1184, 768])
##################################### peak mem #####################################
8657.14111328125MB
##################################### batch time #####################################
1133.4385871887207ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 1184])
##################################### peak mem #####################################
11989.7373046875MB
##################################### batch time #####################################
1352.081298828125ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1088])
##################################### peak mem #####################################
9241.68017578125MB
##################################### batch time #####################################
1542.9410934448242ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 928])
##################################### peak mem #####################################
7189.2353515625MB
##################################### batch time #####################################
1176.4771938323975ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.25634765625MB
##################################### batch time #####################################
1078.279733657837ms
##################################### input shape #####################################
torch.Size([6, 3, 640, 992])
##################################### peak mem #####################################
7491.10986328125MB
##################################### batch time #####################################
1069.8959827423096ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1216])
##################################### peak mem #####################################
8537.46044921875MB
##################################### batch time #####################################
1001.3456344604492ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 928])
##################################### peak mem #####################################
7232.67919921875MB
##################################### batch time #####################################
1064.9778842926025ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7870.98974609375MB
##################################### batch time #####################################
974.2662906646729ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 800])
##################################### peak mem #####################################
8769.16748046875MB
##################################### batch time #####################################
1178.462266921997ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7872.2392578125MB
##################################### batch time #####################################
1169.219970703125ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7575.69873046875MB
##################################### batch time #####################################
1058.7832927703857ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1152])
##################################### peak mem #####################################
9088.8994140625MB
##################################### batch time #####################################
1075.4938125610352ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 768])
##################################### peak mem #####################################
8009.955078125MB
##################################### batch time #####################################
1136.7242336273193ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
2023-02-19 11:49:33,525 - mmdet - INFO - Epoch [1][50/19545]	lr: 9.890e-04, eta: 6:57:50, time: 1.286, data_time: 0.279, memory: 7142, loss_cls: 1.1832, loss_bbox: 0.7252, loss: 1.9085
##################################### peak mem #####################################
8769.16748046875MB
##################################### batch time #####################################
1095.0188636779785ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 992])
##################################### peak mem #####################################
7083.82470703125MB
##################################### batch time #####################################
1148.2515335083008ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 960])
##################################### peak mem #####################################
7147.34375MB
##################################### batch time #####################################
1090.015172958374ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8092.49462890625MB
##################################### batch time #####################################
1100.945234298706ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1088])
##################################### peak mem #####################################
9236.44580078125MB
##################################### batch time #####################################
1181.2126636505127ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 992])
##################################### peak mem #####################################
7568.08984375MB
##################################### batch time #####################################
1191.683292388916ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.0322265625MB
##################################### batch time #####################################
1176.6433715820312ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.103515625MB
##################################### batch time #####################################
1169.16823387146ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 640])
##################################### peak mem #####################################
7574.84765625MB
##################################### batch time #####################################
973.625659942627ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7871.48095703125MB
##################################### batch time #####################################
857.2137355804443ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 864])
##################################### peak mem #####################################
7594.38525390625MB
##################################### batch time #####################################
996.5136051177979ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 992])
##################################### peak mem #####################################
7358.70654296875MB
##################################### batch time #####################################
1027.646780014038ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 768])
##################################### peak mem #####################################
7146.29345703125MB
##################################### batch time #####################################
1003.892183303833ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8546.70263671875MB
##################################### batch time #####################################
1028.3691883087158ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.8447265625MB
##################################### batch time #####################################
1257.349967956543ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8546.49658203125MB
##################################### batch time #####################################
1382.836103439331ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 736])
##################################### peak mem #####################################
7701.77392578125MB
##################################### batch time #####################################
1112.8056049346924ms
##################################### input shape #####################################
torch.Size([6, 3, 1344, 992])
##################################### peak mem #####################################
12382.50830078125MB
##################################### batch time #####################################
1333.4755897521973ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 768])
##################################### peak mem #####################################
7576.30322265625MB
##################################### batch time #####################################
1487.0247840881348ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1344])
##################################### peak mem #####################################
8981.1298828125MB
##################################### batch time #####################################
1067.7070617675781ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.236328125MB
##################################### batch time #####################################
1213.6776447296143ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.55078125MB
##################################### batch time #####################################
1129.8549175262451ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7864.7470703125MB
##################################### batch time #####################################
1138.3588314056396ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.26806640625MB
##################################### batch time #####################################
1179.0554523468018ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 992])
##################################### peak mem #####################################
7919.390625MB
##################################### batch time #####################################
1223.2131958007812ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9216.2490234375MB
##################################### batch time #####################################
1160.5205535888672ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1120])
##################################### peak mem #####################################
8543.34423828125MB
##################################### batch time #####################################
1288.9697551727295ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 1152])
##################################### peak mem #####################################
9412.94873046875MB
##################################### batch time #####################################
1304.0180206298828ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 704])
##################################### peak mem #####################################
7595.5MB
##################################### batch time #####################################
1170.952558517456ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7793.81787109375MB
##################################### batch time #####################################
898.1986045837402ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 864])
##################################### peak mem #####################################
7953.99609375MB
##################################### batch time #####################################
1062.3672008514404ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1088])
##################################### peak mem #####################################
7702.89990234375MB
##################################### batch time #####################################
1098.789930343628ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 800])
##################################### peak mem #####################################
8766.146484375MB
##################################### batch time #####################################
1233.8833808898926ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 1024])
##################################### peak mem #####################################
9304.7490234375MB
##################################### batch time #####################################
1172.1653938293457ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.24658203125MB
##################################### batch time #####################################
1226.395845413208ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1201.5697956085205ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1056])
##################################### peak mem #####################################
7198.6796875MB
##################################### batch time #####################################
1155.7912826538086ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1056])
##################################### peak mem #####################################
8980.09814453125MB
##################################### batch time #####################################
1180.6704998016357ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1024])
##################################### peak mem #####################################
7596.1748046875MB
##################################### batch time #####################################
1210.12282371521ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 1024])
##################################### peak mem #####################################
7281.8271484375MB
##################################### batch time #####################################
934.8175525665283ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 864])
##################################### peak mem #####################################
7529.623046875MB
##################################### batch time #####################################
980.4656505584717ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 928])
##################################### peak mem #####################################
7231.39599609375MB
##################################### batch time #####################################
941.2600994110107ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.259765625MB
##################################### batch time #####################################
1014.3923759460449ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.18017578125MB
##################################### batch time #####################################
1099.0426540374756ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 960])
##################################### peak mem #####################################
7684.94384765625MB
##################################### batch time #####################################
1077.1052837371826ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 928])
##################################### peak mem #####################################
7190.1982421875MB
##################################### batch time #####################################
1048.8145351409912ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.31494140625MB
##################################### batch time #####################################
1099.7908115386963ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8991.76611328125MB
##################################### batch time #####################################
1253.713846206665ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7863.43603515625MB
##################################### batch time #####################################
1184.0548515319824ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8992.107421875MB
##################################### batch time #####################################
1156.632423400879ms
2023-02-19 11:50:30,492 - mmdet - INFO - Epoch [1][100/19545]	lr: 1.988e-03, eta: 6:33:00, time: 1.139, data_time: 0.248, memory: 7974, loss_cls: 1.1785, loss_bbox: 0.7201, loss: 1.8986
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8090.53955078125MB
##################################### batch time #####################################
1301.306962966919ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7910.02001953125MB
##################################### batch time #####################################
1120.8791732788086ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1344])
##################################### peak mem #####################################
10116.341796875MB
##################################### batch time #####################################
1193.1180953979492ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.18017578125MB
##################################### batch time #####################################
1263.6373043060303ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8543.17333984375MB
##################################### batch time #####################################
1091.0217761993408ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 896])
##################################### peak mem #####################################
7557.50244140625MB
##################################### batch time #####################################
1107.7320575714111ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 928])
##################################### peak mem #####################################
7711.919921875MB
##################################### batch time #####################################
1039.839267730713ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 960])
##################################### peak mem #####################################
7461.80517578125MB
##################################### batch time #####################################
1065.7885074615479ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 960])
##################################### peak mem #####################################
7685.0625MB
##################################### batch time #####################################
1001.9762516021729ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 896])
##################################### peak mem #####################################
7220.50390625MB
##################################### batch time #####################################
1067.9655075073242ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
7413.16796875MB
##################################### batch time #####################################
1006.9940090179443ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1088])
##################################### peak mem #####################################
7703.10205078125MB
##################################### batch time #####################################
1093.1169986724854ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.25537109375MB
##################################### batch time #####################################
1107.4700355529785ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1216])
##################################### peak mem #####################################
9559.22021484375MB
##################################### batch time #####################################
1187.417984008789ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.2978515625MB
##################################### batch time #####################################
1198.2741355895996ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 800])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
1080.3651809692383ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 768])
##################################### peak mem #####################################
7530.451171875MB
##################################### batch time #####################################
1060.1630210876465ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1082.5145244598389ms
##################################### input shape #####################################
torch.Size([6, 3, 1248, 800])
##################################### peak mem #####################################
9441.1845703125MB
##################################### batch time #####################################
1321.0835456848145ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8992.2021484375MB
##################################### batch time #####################################
1324.467658996582ms
##################################### input shape #####################################
torch.Size([6, 3, 1056, 1088])
##################################### peak mem #####################################
10761.84130859375MB
##################################### batch time #####################################
1351.1784076690674ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7641.2685546875MB
##################################### batch time #####################################
1335.679054260254ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1117.032527923584ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.25146484375MB
##################################### batch time #####################################
1216.3136005401611ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1154.2789936065674ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 768])
##################################### peak mem #####################################
7359.603515625MB
##################################### batch time #####################################
1174.699068069458ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 928])
##################################### peak mem #####################################
9538.50244140625MB
##################################### batch time #####################################
1123.35205078125ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
7413.89990234375MB
##################################### batch time #####################################
1231.9574356079102ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 1120])
##################################### peak mem #####################################
10427.80615234375MB
##################################### batch time #####################################
1220.984697341919ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.8310546875MB
##################################### batch time #####################################
1429.9912452697754ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 864])
##################################### peak mem #####################################
7231.404296875MB
##################################### batch time #####################################
1117.865800857544ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1175.1081943511963ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1312])
##################################### peak mem #####################################
9519.59228515625MB
##################################### batch time #####################################
1255.969762802124ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.26123046875MB
##################################### batch time #####################################
1200.871229171753ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1088])
##################################### peak mem #####################################
8010.4765625MB
##################################### batch time #####################################
1081.8688869476318ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7864.1611328125MB
##################################### batch time #####################################
1118.9687252044678ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 1024])
##################################### peak mem #####################################
11605.048828125MB
##################################### batch time #####################################
1235.6107234954834ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 992])
##################################### peak mem #####################################
7380.62353515625MB
##################################### batch time #####################################
1346.0772037506104ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
989.1543388366699ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1088])
##################################### peak mem #####################################
7396.97314453125MB
##################################### batch time #####################################
1113.7654781341553ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 736])
##################################### peak mem #####################################
7702.3740234375MB
##################################### batch time #####################################
1070.0860023498535ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1120])
##################################### peak mem #####################################
9801.11181640625MB
##################################### batch time #####################################
1180.4912090301514ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 864])
##################################### peak mem #####################################
7531.1201171875MB
##################################### batch time #####################################
1241.058349609375ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1056])
##################################### peak mem #####################################
8981.26123046875MB
##################################### batch time #####################################
1104.447841644287ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 704])
##################################### peak mem #####################################
7380.62353515625MB
##################################### batch time #####################################
1109.5633506774902ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1120])
##################################### peak mem #####################################
8544.5458984375MB
##################################### batch time #####################################
1136.4092826843262ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1160.2985858917236ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7794.33154296875MB
##################################### batch time #####################################
1117.6362037658691ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.81005859375MB
##################################### batch time #####################################
1163.1391048431396ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 768])
##################################### peak mem #####################################
7575.87646484375MB
2023-02-19 11:51:28,289 - mmdet - INFO - Epoch [1][150/19545]	lr: 2.987e-03, eta: 6:25:52, time: 1.156, data_time: 0.242, memory: 7340, loss_cls: 1.1798, loss_bbox: 0.7276, loss: 1.9074
##################################### batch time #####################################
1191.6115283966064ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 896])
##################################### peak mem #####################################
8476.95703125MB
##################################### batch time #####################################
1055.1588535308838ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 1024])
##################################### peak mem #####################################
7281.26611328125MB
##################################### batch time #####################################
1072.0198154449463ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 832])
##################################### peak mem #####################################
8856.33447265625MB
##################################### batch time #####################################
1043.6863899230957ms
##################################### input shape #####################################
torch.Size([6, 3, 1344, 896])
##################################### peak mem #####################################
11248.015625MB
##################################### batch time #####################################
1256.955862045288ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1088])
##################################### peak mem #####################################
8624.16552734375MB
##################################### batch time #####################################
1405.7528972625732ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8090.4091796875MB
##################################### batch time #####################################
1148.667573928833ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1056])
##################################### peak mem #####################################
8388.9736328125MB
##################################### batch time #####################################
1205.4836750030518ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1344])
##################################### peak mem #####################################
10117.89599609375MB
##################################### batch time #####################################
1246.5488910675049ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1056])
##################################### peak mem #####################################
7495.814453125MB
##################################### batch time #####################################
1343.6686992645264ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.08642578125MB
##################################### batch time #####################################
1083.4150314331055ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7864.06201171875MB
##################################### batch time #####################################
1135.4799270629883ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 896])
##################################### peak mem #####################################
7220.50390625MB
##################################### batch time #####################################
1056.255578994751ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 768])
##################################### peak mem #####################################
8227.33251953125MB
##################################### batch time #####################################
1010.0700855255127ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1120])
##################################### peak mem #####################################
8855.21142578125MB
##################################### batch time #####################################
1214.7517204284668ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 960])
##################################### peak mem #####################################
9842.56201171875MB
##################################### batch time #####################################
1293.5492992401123ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 992])
##################################### peak mem #####################################
8204.24072265625MB
##################################### batch time #####################################
1319.3385601043701ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1120])
##################################### peak mem #####################################
9800.96875MB
##################################### batch time #####################################
1190.6864643096924ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1216])
##################################### peak mem #####################################
9559.22119140625MB
##################################### batch time #####################################
1342.7963256835938ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 768])
##################################### peak mem #####################################
8439.21875MB
##################################### batch time #####################################
1277.1687507629395ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1312])
##################################### peak mem #####################################
9889.0869140625MB
##################################### batch time #####################################
1204.1828632354736ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.798828125MB
##################################### batch time #####################################
1286.5986824035645ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1024])
##################################### peak mem #####################################
7290.4560546875MB
##################################### batch time #####################################
1131.9594383239746ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 864])
##################################### peak mem #####################################
8440.94677734375MB
##################################### batch time #####################################
1251.1274814605713ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 800])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
1342.1096801757812ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1152])
##################################### peak mem #####################################
8439.7392578125MB
##################################### batch time #####################################
1230.6063175201416ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 704])
##################################### peak mem #####################################
7395.99609375MB
##################################### batch time #####################################
1114.0334606170654ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 864])
##################################### peak mem #####################################
7470.75MB
##################################### batch time #####################################
1158.1835746765137ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1344])
##################################### peak mem #####################################
9737.64111328125MB
##################################### batch time #####################################
1107.7632904052734ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1216])
##################################### peak mem #####################################
10239.97021484375MB
##################################### batch time #####################################
1360.5191707611084ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 928])
##################################### peak mem #####################################
7522.66064453125MB
##################################### batch time #####################################
1345.4513549804688ms
##################################### input shape #####################################
torch.Size([6, 3, 1056, 800])
##################################### peak mem #####################################
8090.4091796875MB
##################################### batch time #####################################
1120.5017566680908ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 736])
##################################### peak mem #####################################
7486.400390625MB
##################################### batch time #####################################
1084.632396697998ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.70458984375MB
##################################### batch time #####################################
990.0000095367432ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.26318359375MB
##################################### batch time #####################################
1071.0711479187012ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1344])
##################################### peak mem #####################################
9737.697265625MB
##################################### batch time #####################################
1293.034553527832ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.25537109375MB
##################################### batch time #####################################
1298.6276149749756ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1312])
##################################### peak mem #####################################
9889.0869140625MB
##################################### batch time #####################################
1813.450574874878ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 896])
##################################### peak mem #####################################
7587.083984375MB
##################################### batch time #####################################
1377.1193027496338ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.49072265625MB
##################################### batch time #####################################
1027.3852348327637ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.49072265625MB
##################################### batch time #####################################
1263.8492584228516ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.08642578125MB
##################################### batch time #####################################
1858.0760955810547ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8768.0732421875MB
##################################### batch time #####################################
1399.4910717010498ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 864])
##################################### peak mem #####################################
7711.34423828125MB
##################################### batch time #####################################
1858.5960865020752ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1273.0162143707275ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 928])
##################################### peak mem #####################################
7521.0498046875MB
##################################### batch time #####################################
1085.8173370361328ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1112.687587738037ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 736])
##################################### peak mem #####################################
7590.49169921875MB
##################################### batch time #####################################
1737.7243041992188ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 832])
##################################### peak mem #####################################
7221.03369140625MB
##################################### batch time #####################################
1100.5830764770508ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1088])
##################################### peak mem #####################################
8624.16552734375MB
##################################### batch time #####################################
1184.6134662628174ms
##################################### input shape #####################################
2023-02-19 11:52:31,414 - mmdet - INFO - Epoch [1][200/19545]	lr: 3.986e-03, eta: 6:30:25, time: 1.262, data_time: 0.245, memory: 9280, loss_cls: 1.1691, loss_bbox: 0.7184, loss: 1.8875
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.83740234375MB
##################################### batch time #####################################
1302.1697998046875ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.818359375MB
##################################### batch time #####################################
1283.5962772369385ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9215.06982421875MB
##################################### batch time #####################################
1276.5185832977295ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 736])
##################################### peak mem #####################################
7598.5537109375MB
##################################### batch time #####################################
1619.4663047790527ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 1088])
##################################### peak mem #####################################
8930.08740234375MB
##################################### batch time #####################################
1126.2242794036865ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1341.2575721740723ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.94873046875MB
##################################### batch time #####################################
1274.8386859893799ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1056])
##################################### peak mem #####################################
9280.7783203125MB
##################################### batch time #####################################
1351.3734340667725ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 1216])
##################################### peak mem #####################################
10923.19140625MB
##################################### batch time #####################################
1394.301176071167ms
Traceback (most recent call last):
  File "/workspace/mimose-mmdet/tools/train.py", line 192, in <module>
    main()
  File "/workspace/mimose-mmdet/tools/train.py", line 181, in main
    train_detector(
  File "/workspace/mimose-mmdet/mmdet/apis/train.py", line 191, in train_detector
    runner.run(data_loaders, cfg.workflow)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 136, in run
    epoch_runner(data_loaders[i], **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 53, in train
    self.run_iter(data_batch, train_mode=True, **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 31, in run_iter
    outputs = self.model.train_step(data_batch, self.optimizer,
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/parallel/data_parallel.py", line 77, in train_step
    return self.module.train_step(*inputs[0], **kwargs[0])
  File "/workspace/mimose-mmdet/mmdet/models/detectors/base.py", line 251, in train_step
    losses = self(**data)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/fp16_utils.py", line 119, in new_func
    return old_func(*args, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/detectors/base.py", line 181, in forward
    return self.forward_train(img, img_metas, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/detectors/single_stage.py", line 159, in forward_train
    losses = self.bbox_head.forward_train(x, img_metas, gt_bboxes,
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/base_dense_head.py", line 54, in forward_train
    losses = self.loss(*loss_inputs, gt_bboxes_ignore=gt_bboxes_ignore)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/fp16_utils.py", line 208, in new_func
    return old_func(*args, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/anchor_head.py", line 483, in loss
    losses_cls, losses_bbox = multi_apply(
  File "/workspace/mimose-mmdet/mmdet/core/utils/misc.py", line 29, in multi_apply
    return tuple(map(list, zip(*map_results)))
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/anchor_head.py", line 406, in loss_single
    loss_cls = self.loss_cls(
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/losses/focal_loss.py", line 170, in forward
    loss_cls = self.loss_weight * calculate_loss_func(
  File "/workspace/mimose-mmdet/mmdet/models/losses/focal_loss.py", line 101, in sigmoid_focal_loss
    loss = weight_reduce_loss(loss, weight, reduction, avg_factor)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/utils/parrots_jit.py", line 22, in wrapper_inner
    return func(*args, **kargs)
  File "/workspace/mimose-mmdet/mmdet/models/losses/utils.py", line 42, in weight_reduce_loss
    loss = loss * weight
RuntimeError: CUDA out of memory. Tried to allocate 352.00 MiB (GPU 0; 31.75 GiB total capacity; 12.00 GiB already allocated; 17.44 GiB free; 13.00 GiB allowed; 12.89 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
