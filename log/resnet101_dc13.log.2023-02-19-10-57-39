/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/__init__.py:20: UserWarning: On January 1, 2023, MMCV will release v2.0.0, in which it will remove components related to the training process and add a data transformation module. In addition, it will rename the package names mmcv to mmcv-lite and mmcv-full to mmcv. See https://github.com/open-mmlab/mmcv/blob/master/docs/en/compatibility.md for more details.
  warnings.warn(
2023-02-19 10:57:45,397 - mmdet - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.9.16 (main, Jan 11 2023, 16:05:54) [GCC 11.2.0]
CUDA available: True
GPU 0: Tesla V100-PCIE-32GB
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 11.3, V11.3.109
GCC: gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0
PyTorch: 1.11.0+cu113
PyTorch compiling details: PyTorch built with:
  - GCC 7.3
  - C++ Version: 201402
  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.5.2 (Git Hash a9302535553c73243c632ad3c4c80beec3d19a1e)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.3
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86
  - CuDNN 8.2
  - Magma 2.5.2
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.3, CUDNN_VERSION=8.2.0, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.11.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=OFF, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

TorchVision: 0.12.0+cu113
OpenCV: 4.7.0
MMCV: 1.7.1
MMCV Compiler: GCC 7.5
MMCV CUDA Compiler: 11.3
MMDetection: 2.11.0+e10e3d6
------------------------------------------------------------

2023-02-19 10:57:48,138 - mmdet - INFO - Distributed training: False
2023-02-19 10:57:50,872 - mmdet - INFO - Config:
model = dict(
    type='RetinaNet',
    pretrained='torchvision://resnet101',
    backbone=dict(
        type='ResNet',
        depth=101,
        num_stages=4,
        out_indices=(0, 1, 2, 3),
        frozen_stages=1,
        norm_cfg=dict(type='BN', requires_grad=True),
        norm_eval=True,
        style='pytorch'),
    neck=dict(
        type='FPN',
        in_channels=[256, 512, 1024, 2048],
        out_channels=256,
        start_level=1,
        add_extra_convs='on_input',
        num_outs=5),
    bbox_head=dict(
        type='RetinaHead',
        num_classes=80,
        in_channels=256,
        stacked_convs=4,
        feat_channels=256,
        anchor_generator=dict(
            type='AnchorGenerator',
            octave_base_scale=4,
            scales_per_octave=3,
            ratios=[0.5, 1.0, 2.0],
            strides=[8, 16, 32, 64, 128]),
        bbox_coder=dict(
            type='DeltaXYWHBBoxCoder',
            target_means=[0.0, 0.0, 0.0, 0.0],
            target_stds=[1.0, 1.0, 1.0, 1.0]),
        loss_cls=dict(
            type='FocalLoss',
            use_sigmoid=True,
            gamma=2.0,
            alpha=0.25,
            loss_weight=1.0),
        loss_bbox=dict(type='L1Loss', loss_weight=1.0)),
    train_cfg=dict(
        assigner=dict(
            type='MaxIoUAssigner',
            pos_iou_thr=0.5,
            neg_iou_thr=0.4,
            min_pos_iou=0,
            ignore_iof_thr=-1),
        allowed_border=-1,
        pos_weight=-1,
        debug=False),
    test_cfg=dict(
        nms_pre=1000,
        min_bbox_size=0,
        score_thr=0.05,
        nms=dict(type='nms', iou_threshold=0.5),
        max_per_img=100))
dataset_type = 'CocoDataset'
data_root = 'data/coco/'
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(
        type='AutoAugment',
        policies=[[{
            'type':
            'Resize',
            'img_scale': [(480, 1333), (512, 1333), (544, 1333), (576, 1333),
                          (608, 1333), (640, 1333), (672, 1333), (704, 1333),
                          (736, 1333), (768, 1333), (800, 1333)],
            'multiscale_mode':
            'value',
            'keep_ratio':
            True
        }],
                  [{
                      'type': 'Resize',
                      'img_scale': [(400, 1333), (500, 1333), (600, 1333)],
                      'multiscale_mode': 'value',
                      'keep_ratio': True
                  }, {
                      'type': 'RandomCrop',
                      'crop_type': 'absolute_range',
                      'crop_size': (384, 600),
                      'allow_negative_crop': True
                  }, {
                      'type':
                      'Resize',
                      'img_scale': [(480, 1333), (512, 1333), (544, 1333),
                                    (576, 1333), (608, 1333), (640, 1333),
                                    (672, 1333), (704, 1333), (736, 1333),
                                    (768, 1333), (800, 1333)],
                      'multiscale_mode':
                      'value',
                      'override':
                      True,
                      'keep_ratio':
                      True
                  }]]),
    dict(
        type='Normalize',
        mean=[123.675, 116.28, 103.53],
        std=[58.395, 57.12, 57.375],
        to_rgb=True),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
]
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        type='MultiScaleFlipAug',
        img_scale=(1333, 800),
        flip=False,
        transforms=[
            dict(type='Resize', keep_ratio=True),
            dict(type='RandomFlip'),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='ImageToTensor', keys=['img']),
            dict(type='Collect', keys=['img'])
        ])
]
data = dict(
    samples_per_gpu=6,
    workers_per_gpu=0,
    train=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_train2017.json',
        img_prefix='data/coco/train2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(type='LoadAnnotations', with_bbox=True, with_mask=True),
            dict(type='RandomFlip', flip_ratio=0.5),
            dict(
                type='AutoAugment',
                policies=[[{
                    'type':
                    'Resize',
                    'img_scale': [(480, 1333), (512, 1333), (544, 1333),
                                  (576, 1333), (608, 1333), (640, 1333),
                                  (672, 1333), (704, 1333), (736, 1333),
                                  (768, 1333), (800, 1333)],
                    'multiscale_mode':
                    'value',
                    'keep_ratio':
                    True
                }],
                          [{
                              'type': 'Resize',
                              'img_scale': [(400, 1333), (500, 1333),
                                            (600, 1333)],
                              'multiscale_mode': 'value',
                              'keep_ratio': True
                          }, {
                              'type': 'RandomCrop',
                              'crop_type': 'absolute_range',
                              'crop_size': (384, 600),
                              'allow_negative_crop': True
                          }, {
                              'type':
                              'Resize',
                              'img_scale': [(480, 1333), (512, 1333),
                                            (544, 1333), (576, 1333),
                                            (608, 1333), (640, 1333),
                                            (672, 1333), (704, 1333),
                                            (736, 1333), (768, 1333),
                                            (800, 1333)],
                              'multiscale_mode':
                              'value',
                              'override':
                              True,
                              'keep_ratio':
                              True
                          }]]),
            dict(
                type='Normalize',
                mean=[123.675, 116.28, 103.53],
                std=[58.395, 57.12, 57.375],
                to_rgb=True),
            dict(type='Pad', size_divisor=32),
            dict(type='DefaultFormatBundle'),
            dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels'])
        ]),
    val=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_val2017.json',
        img_prefix='data/coco/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]),
    test=dict(
        type='CocoDataset',
        ann_file='data/coco/annotations/instances_val2017.json',
        img_prefix='data/coco/val2017/',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(
                type='MultiScaleFlipAug',
                img_scale=(1333, 800),
                flip=False,
                transforms=[
                    dict(type='Resize', keep_ratio=True),
                    dict(type='RandomFlip'),
                    dict(
                        type='Normalize',
                        mean=[123.675, 116.28, 103.53],
                        std=[58.395, 57.12, 57.375],
                        to_rgb=True),
                    dict(type='Pad', size_divisor=32),
                    dict(type='ImageToTensor', keys=['img']),
                    dict(type='Collect', keys=['img'])
                ])
        ]))
evaluation = dict(interval=1, metric='bbox')
optimizer = dict(type='SGD', lr=0.01, momentum=0.9, weight_decay=0.0001)
optimizer_config = dict(
    grad_clip=None,
    type='DistOptimizerHook',
    update_interval=1,
    coalesce=True,
    bucket_size_mb=-1,
    use_fp16=False,
    memory_threshold=13,
    memory_buffer=5,
    dc=dict(enable=True, warmup_iters=30))
lr_config = dict(
    policy='step',
    warmup='linear',
    warmup_iters=500,
    warmup_ratio=0.001,
    step=[8, 11])
runner = dict(type='EpochBasedRunner', max_epochs=1)
checkpoint_config = dict(interval=1)
log_config = dict(interval=50, hooks=[dict(type='TextLoggerHook')])
custom_hooks = [dict(type='NumClassCheckHook')]
dist_params = dict(backend='nccl')
log_level = 'INFO'
load_from = None
resume_from = None
workflow = [('train', 1)]
fp16 = None
work_dir = './work_dirs/retinanet_r101_fpn_1x_coco_dc13'
gpu_ids = range(0, 1)

2023-02-19 10:57:50,872 - mmdet - INFO - Set random seed to 42, deterministic: False
2023-02-19 10:57:51,483 - mmdet - INFO - load model from: torchvision://resnet101
2023-02-19 10:57:51,483 - mmdet - INFO - load checkpoint from torchvision path: torchvision://resnet101
2023-02-19 10:57:52,126 - mmdet - WARNING - The model and loaded state dict do not match exactly

unexpected key in source state_dict: fc.weight, fc.bias

2023-02-19 10:58:17,945 - mmdet - INFO - Start running, host: root@53f4750e67dd, work_dir: /workspace/mimose-mmdet/work_dirs/retinanet_r101_fpn_1x_coco_dc13
2023-02-19 10:58:17,945 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) EvalHook                           
(NORMAL      ) NumClassCheckHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook                  
(ABOVE_NORMAL) DistOptimizerHook                  
(LOW         ) IterTimerHook                      
 -------------------- 
after_train_iter:
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_train_epoch:
(ABOVE_NORMAL) DistOptimizerHook                  
(NORMAL      ) CheckpointHook                     
(NORMAL      ) EvalHook                           
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_epoch:
(NORMAL      ) NumClassCheckHook                  
(LOW         ) IterTimerHook                      
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
before_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_iter:
(LOW         ) IterTimerHook                      
 -------------------- 
after_val_epoch:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
after_run:
(VERY_LOW    ) TextLoggerHook                     
 -------------------- 
2023-02-19 10:58:17,946 - mmdet - INFO - workflow: [('train', 1)], max: 1 epochs
2023-02-19 10:58:17,946 - mmdet - INFO - Checkpoints will be saved to /workspace/mimose-mmdet/work_dirs/retinanet_r101_fpn_1x_coco_dc13 by HardDiskBackend.
apex is not installed
apex is not installed
apex is not installed
apex is not installed
Seed set to 42 and deterministic=False
loading annotations into memory...
Done (t=17.37s)
creating index...
index created!
Memory threshold: 13 GiB
dc manager max memory GB: 8
loading annotations into memory...
Done (t=0.51s)
creating index...
index created!
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8339.88623046875MB
##################################### batch time #####################################
1676804300788.2244ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9218.6201171875MB
##################################### batch time #####################################
1427.5777339935303ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1184])
##################################### peak mem #####################################
8341.4453125MB
##################################### batch time #####################################
4928.326368331909ms
##################################### input shape #####################################
torch.Size([6, 3, 1184, 768])
##################################### peak mem #####################################
8687.87548828125MB
##################################### batch time #####################################
1463.0730152130127ms
##################################### input shape #####################################
torch.Size([6, 3, 640, 832])
##################################### peak mem #####################################
5357.6416015625MB
##################################### batch time #####################################
1339.7893905639648ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 704])
##################################### peak mem #####################################
7402.17919921875MB
##################################### batch time #####################################
1157.2961807250977ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9243.49462890625MB
##################################### batch time #####################################
1527.7624130249023ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 960])
##################################### peak mem #####################################
6877.37109375MB
##################################### batch time #####################################
1596.9367027282715ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9243.07568359375MB
##################################### batch time #####################################
1463.634967803955ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9244.18017578125MB
##################################### batch time #####################################
1587.1002674102783ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8327.91796875MB
##################################### batch time #####################################
3956.80570602417ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8328.0703125MB
##################################### batch time #####################################
6033.307075500488ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7574.1142578125MB
##################################### batch time #####################################
5051.9514083862305ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7896.541015625MB
##################################### batch time #####################################
4198.721885681152ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8780.8310546875MB
##################################### batch time #####################################
2866.013765335083ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1024])
##################################### peak mem #####################################
7006.49658203125MB
##################################### batch time #####################################
1442.8470134735107ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 960])
##################################### peak mem #####################################
6365.0107421875MB
##################################### batch time #####################################
1338.3221626281738ms
##################################### input shape #####################################
torch.Size([6, 3, 512, 864])
##################################### peak mem #####################################
4554.359375MB
##################################### batch time #####################################
1072.1514225006104ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1152])
##################################### peak mem #####################################
9109.38671875MB
##################################### batch time #####################################
1242.4695491790771ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1088])
##################################### peak mem #####################################
8025.00927734375MB
##################################### batch time #####################################
3485.0211143493652ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9244.009765625MB
##################################### batch time #####################################
3046.489953994751ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 736])
##################################### peak mem #####################################
6472.9169921875MB
##################################### batch time #####################################
3717.8263664245605ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7927.5048828125MB
##################################### batch time #####################################
1256.359338760376ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1152])
##################################### peak mem #####################################
8472.2705078125MB
##################################### batch time #####################################
1423.0787754058838ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 992])
##################################### peak mem #####################################
7086.94970703125MB
##################################### batch time #####################################
1370.6886768341064ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 992])
##################################### peak mem #####################################
8204.06494140625MB
##################################### batch time #####################################
3536.0543727874756ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 960])
##################################### peak mem #####################################
8240.38427734375MB
##################################### batch time #####################################
3795.6459522247314ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7928.212890625MB
##################################### batch time #####################################
4344.966650009155ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8781.17431640625MB
##################################### batch time #####################################
3911.1220836639404ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 704])
##################################### peak mem #####################################
7007.09228515625MB
##################################### batch time #####################################
3227.3898124694824ms
fit memory consume
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9246.85400390625MB
##################################### batch time #####################################
1356.1720848083496ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9246.27099609375MB
##################################### batch time #####################################
1497.2617626190186ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
8050.0517578125MB
##################################### batch time #####################################
1235.1274490356445ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 768])
##################################### peak mem #####################################
8225.39306640625MB
##################################### batch time #####################################
1083.6281776428223ms
##################################### input shape #####################################
torch.Size([6, 3, 1184, 768])
##################################### peak mem #####################################
8657.14111328125MB
##################################### batch time #####################################
1174.4403839111328ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 1184])
##################################### peak mem #####################################
11989.7373046875MB
##################################### batch time #####################################
1509.1361999511719ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1088])
##################################### peak mem #####################################
9241.68017578125MB
##################################### batch time #####################################
1729.8505306243896ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 928])
##################################### peak mem #####################################
7801.0498046875MB
##################################### batch time #####################################
1245.3749179840088ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.25634765625MB
##################################### batch time #####################################
1134.516954421997ms
##################################### input shape #####################################
torch.Size([6, 3, 640, 992])
##################################### peak mem #####################################
7956.10986328125MB
##################################### batch time #####################################
1194.8227882385254ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1216])
##################################### peak mem #####################################
8537.46044921875MB
##################################### batch time #####################################
1077.2900581359863ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 928])
##################################### peak mem #####################################
8014.31982421875MB
##################################### batch time #####################################
2975.235939025879ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7870.98974609375MB
##################################### batch time #####################################
3585.590124130249ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 800])
##################################### peak mem #####################################
8769.16748046875MB
##################################### batch time #####################################
3138.355016708374ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7872.2392578125MB
##################################### batch time #####################################
2557.6913356781006ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7575.69873046875MB
##################################### batch time #####################################
1125.3132820129395ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1152])
##################################### peak mem #####################################
9088.8994140625MB
##################################### batch time #####################################
1156.7165851593018ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 768])
##################################### peak mem #####################################
8009.955078125MB
##################################### batch time #####################################
1257.18355178833ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
2023-02-19 11:00:10,611 - mmdet - INFO - Epoch [1][50/19545]	lr: 9.890e-04, eta: 12:12:02, time: 2.253, data_time: 1.242, memory: 7744, loss_cls: 1.1832, loss_bbox: 0.7252, loss: 1.9085
##################################### peak mem #####################################
8769.16748046875MB
##################################### batch time #####################################
1163.0055904388428ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 992])
##################################### peak mem #####################################
7686.69482421875MB
##################################### batch time #####################################
1299.0968227386475ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 960])
##################################### peak mem #####################################
7754.9482421875MB
##################################### batch time #####################################
1154.1953086853027ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8092.49462890625MB
##################################### batch time #####################################
1172.537088394165ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1088])
##################################### peak mem #####################################
9236.44580078125MB
##################################### batch time #####################################
1248.274326324463ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 992])
##################################### peak mem #####################################
8085.86376953125MB
##################################### batch time #####################################
3444.493532180786ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.0322265625MB
##################################### batch time #####################################
6509.363174438477ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.103515625MB
##################################### batch time #####################################
4168.238401412964ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 640])
##################################### peak mem #####################################
8110.9169921875MB
##################################### batch time #####################################
3844.2001342773438ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7871.48095703125MB
##################################### batch time #####################################
1015.7301425933838ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 864])
##################################### peak mem #####################################
8109.88818359375MB
##################################### batch time #####################################
2432.7571392059326ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 992])
##################################### peak mem #####################################
7985.97119140625MB
##################################### batch time #####################################
3075.136184692383ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 768])
##################################### peak mem #####################################
7753.98681640625MB
##################################### batch time #####################################
3392.167806625366ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8546.70263671875MB
##################################### batch time #####################################
3365.246534347534ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.8447265625MB
##################################### batch time #####################################
1396.4691162109375ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8546.49658203125MB
##################################### batch time #####################################
1685.7974529266357ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 736])
##################################### peak mem #####################################
7701.77392578125MB
##################################### batch time #####################################
1440.0010108947754ms
##################################### input shape #####################################
torch.Size([6, 3, 1344, 992])
##################################### peak mem #####################################
12382.50830078125MB
##################################### batch time #####################################
1441.2274360656738ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 768])
##################################### peak mem #####################################
7576.30322265625MB
##################################### batch time #####################################
1550.8451461791992ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1344])
##################################### peak mem #####################################
8981.1298828125MB
##################################### batch time #####################################
1120.6891536712646ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.236328125MB
##################################### batch time #####################################
1271.803617477417ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1184])
##################################### peak mem #####################################
8659.55078125MB
##################################### batch time #####################################
1186.079978942871ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7864.7470703125MB
##################################### batch time #####################################
1179.7823905944824ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.26806640625MB
##################################### batch time #####################################
1226.8493175506592ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 992])
##################################### peak mem #####################################
7919.390625MB
##################################### batch time #####################################
1316.1425590515137ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9216.2490234375MB
##################################### batch time #####################################
1260.3154182434082ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1120])
##################################### peak mem #####################################
8543.34423828125MB
##################################### batch time #####################################
1442.659854888916ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 1152])
##################################### peak mem #####################################
9412.94873046875MB
##################################### batch time #####################################
1407.3426723480225ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 704])
##################################### peak mem #####################################
8112.77880859375MB
##################################### batch time #####################################
3641.577959060669ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7793.81787109375MB
##################################### batch time #####################################
1159.4295501708984ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 864])
##################################### peak mem #####################################
7953.99609375MB
##################################### batch time #####################################
1223.907709121704ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1088])
##################################### peak mem #####################################
7702.89990234375MB
##################################### batch time #####################################
1227.4415493011475ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 800])
##################################### peak mem #####################################
8766.146484375MB
##################################### batch time #####################################
1324.1333961486816ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 1024])
##################################### peak mem #####################################
9304.7490234375MB
##################################### batch time #####################################
1223.6967086791992ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.24658203125MB
##################################### batch time #####################################
1303.1046390533447ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1565.5417442321777ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1056])
##################################### peak mem #####################################
7811.2900390625MB
##################################### batch time #####################################
1318.1605339050293ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1056])
##################################### peak mem #####################################
8980.09814453125MB
##################################### batch time #####################################
1319.3631172180176ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1024])
##################################### peak mem #####################################
8056.64208984375MB
##################################### batch time #####################################
1375.2021789550781ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 1024])
##################################### peak mem #####################################
8069.4560546875MB
##################################### batch time #####################################
1038.120985031128ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 864])
##################################### peak mem #####################################
8045.466796875MB
##################################### batch time #####################################
1017.9314613342285ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 928])
##################################### peak mem #####################################
8013.39111328125MB
##################################### batch time #####################################
1010.2543830871582ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.259765625MB
##################################### batch time #####################################
1087.562084197998ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.18017578125MB
##################################### batch time #####################################
1155.9998989105225ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 960])
##################################### peak mem #####################################
7684.94384765625MB
##################################### batch time #####################################
1227.4584770202637ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 928])
##################################### peak mem #####################################
7801.8076171875MB
##################################### batch time #####################################
1187.9057884216309ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.31494140625MB
##################################### batch time #####################################
1176.9464015960693ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8991.76611328125MB
##################################### batch time #####################################
1318.8552856445312ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 800])
##################################### peak mem #####################################
7863.43603515625MB
##################################### batch time #####################################
1225.1887321472168ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8992.107421875MB
##################################### batch time #####################################
1202.4548053741455ms
2023-02-19 11:01:39,043 - mmdet - INFO - Epoch [1][100/19545]	lr: 1.988e-03, eta: 10:51:40, time: 1.769, data_time: 0.879, memory: 7974, loss_cls: 1.1785, loss_bbox: 0.7201, loss: 1.8986
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8090.53955078125MB
##################################### batch time #####################################
3089.951753616333ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1120])
##################################### peak mem #####################################
7910.02001953125MB
##################################### batch time #####################################
2188.6355876922607ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1344])
##################################### peak mem #####################################
10116.341796875MB
##################################### batch time #####################################
2601.5422344207764ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.18017578125MB
##################################### batch time #####################################
2677.999496459961ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 800])
##################################### peak mem #####################################
8543.17333984375MB
##################################### batch time #####################################
2337.855815887451ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 896])
##################################### peak mem #####################################
8082.40869140625MB
##################################### batch time #####################################
1985.7158660888672ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 928])
##################################### peak mem #####################################
7711.919921875MB
##################################### batch time #####################################
1119.225263595581ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 960])
##################################### peak mem #####################################
7979.30517578125MB
##################################### batch time #####################################
1150.2482891082764ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 960])
##################################### peak mem #####################################
7685.0625MB
##################################### batch time #####################################
1054.6586513519287ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 896])
##################################### peak mem #####################################
7835.58349609375MB
##################################### batch time #####################################
1114.6738529205322ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
8046.8916015625MB
##################################### batch time #####################################
1211.308479309082ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1088])
##################################### peak mem #####################################
7703.10205078125MB
##################################### batch time #####################################
2215.001344680786ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.25537109375MB
##################################### batch time #####################################
2437.8185272216797ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1216])
##################################### peak mem #####################################
9559.22021484375MB
##################################### batch time #####################################
2609.78102684021ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.2978515625MB
##################################### batch time #####################################
2244.875431060791ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 800])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
2206.195592880249ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 768])
##################################### peak mem #####################################
8046.513671875MB
##################################### batch time #####################################
2442.474365234375ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1379.4734477996826ms
##################################### input shape #####################################
torch.Size([6, 3, 1248, 800])
##################################### peak mem #####################################
9441.1845703125MB
##################################### batch time #####################################
1463.304042816162ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1184])
##################################### peak mem #####################################
8992.2021484375MB
##################################### batch time #####################################
1498.8877773284912ms
##################################### input shape #####################################
torch.Size([6, 3, 1056, 1088])
##################################### peak mem #####################################
10761.84130859375MB
##################################### batch time #####################################
1385.3504657745361ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7641.2685546875MB
##################################### batch time #####################################
1388.5607719421387ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1210.7195854187012ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7863.25146484375MB
##################################### batch time #####################################
1347.0971584320068ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
2746.8020915985107ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 768])
##################################### peak mem #####################################
7986.4453125MB
##################################### batch time #####################################
2600.3262996673584ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 928])
##################################### peak mem #####################################
9538.50244140625MB
##################################### batch time #####################################
2027.662754058838ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 960])
##################################### peak mem #####################################
8046.8916015625MB
##################################### batch time #####################################
4656.127452850342ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 1120])
##################################### peak mem #####################################
10427.80615234375MB
##################################### batch time #####################################
2868.701219558716ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.8310546875MB
##################################### batch time #####################################
1493.3123588562012ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 864])
##################################### peak mem #####################################
7847.79248046875MB
##################################### batch time #####################################
1524.3079662322998ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1207.2763442993164ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1312])
##################################### peak mem #####################################
9519.59228515625MB
##################################### batch time #####################################
1322.9560852050781ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.26123046875MB
##################################### batch time #####################################
1239.776849746704ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1088])
##################################### peak mem #####################################
8010.4765625MB
##################################### batch time #####################################
1136.315107345581ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7864.1611328125MB
##################################### batch time #####################################
1208.5747718811035ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 1024])
##################################### peak mem #####################################
11605.048828125MB
##################################### batch time #####################################
1302.781343460083ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 992])
##################################### peak mem #####################################
8116.23681640625MB
##################################### batch time #####################################
1422.5480556488037ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
1011.9092464447021ms
##################################### input shape #####################################
torch.Size([6, 3, 704, 1088])
##################################### peak mem #####################################
8027.71044921875MB
##################################### batch time #####################################
1174.9114990234375ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 736])
##################################### peak mem #####################################
7702.3740234375MB
##################################### batch time #####################################
1108.5550785064697ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1120])
##################################### peak mem #####################################
9801.11181640625MB
##################################### batch time #####################################
1214.5774364471436ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 864])
##################################### peak mem #####################################
8047.1826171875MB
##################################### batch time #####################################
1279.2892456054688ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1056])
##################################### peak mem #####################################
8981.26123046875MB
##################################### batch time #####################################
1156.6805839538574ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 704])
##################################### peak mem #####################################
8116.23681640625MB
##################################### batch time #####################################
1148.4599113464355ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1120])
##################################### peak mem #####################################
8544.5458984375MB
##################################### batch time #####################################
1233.616590499878ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1253.3996105194092ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7794.33154296875MB
##################################### batch time #####################################
1183.2144260406494ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.81005859375MB
##################################### batch time #####################################
1224.3139743804932ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 768])
##################################### peak mem #####################################
7575.87646484375MB
2023-02-19 11:03:03,077 - mmdet - INFO - Epoch [1][150/19545]	lr: 2.987e-03, eta: 10:14:25, time: 1.681, data_time: 0.773, memory: 8128, loss_cls: 1.1798, loss_bbox: 0.7276, loss: 1.9074
##################################### batch time #####################################
1267.0319080352783ms
##################################### input shape #####################################
torch.Size([6, 3, 992, 896])
##################################### peak mem #####################################
8476.95703125MB
##################################### batch time #####################################
1373.7757205963135ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 1024])
##################################### peak mem #####################################
8070.2998046875MB
##################################### batch time #####################################
2681.072473526001ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 832])
##################################### peak mem #####################################
8856.33447265625MB
##################################### batch time #####################################
1990.3337955474854ms
##################################### input shape #####################################
torch.Size([6, 3, 1344, 896])
##################################### peak mem #####################################
11248.015625MB
##################################### batch time #####################################
2184.227466583252ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1088])
##################################### peak mem #####################################
8624.16552734375MB
##################################### batch time #####################################
2358.6926460266113ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1056])
##################################### peak mem #####################################
8090.4091796875MB
##################################### batch time #####################################
1190.8760070800781ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1056])
##################################### peak mem #####################################
8388.9736328125MB
##################################### batch time #####################################
1294.4695949554443ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1344])
##################################### peak mem #####################################
10117.89599609375MB
##################################### batch time #####################################
1392.0669555664062ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1056])
##################################### peak mem #####################################
8067.390625MB
##################################### batch time #####################################
1371.896505355835ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.08642578125MB
##################################### batch time #####################################
1547.5010871887207ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1024])
##################################### peak mem #####################################
7864.06201171875MB
##################################### batch time #####################################
1257.4408054351807ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 896])
##################################### peak mem #####################################
7834.75390625MB
##################################### batch time #####################################
1108.9589595794678ms
##################################### input shape #####################################
torch.Size([6, 3, 1120, 768])
##################################### peak mem #####################################
8227.33251953125MB
##################################### batch time #####################################
1056.729793548584ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1120])
##################################### peak mem #####################################
8855.21142578125MB
##################################### batch time #####################################
1357.408046722412ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 960])
##################################### peak mem #####################################
9842.56201171875MB
##################################### batch time #####################################
1363.4507656097412ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 992])
##################################### peak mem #####################################
8204.24072265625MB
##################################### batch time #####################################
1337.4512195587158ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1120])
##################################### peak mem #####################################
9800.96875MB
##################################### batch time #####################################
1210.6890678405762ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1216])
##################################### peak mem #####################################
9559.22119140625MB
##################################### batch time #####################################
1358.6246967315674ms
##################################### input shape #####################################
torch.Size([6, 3, 1152, 768])
##################################### peak mem #####################################
8439.21875MB
##################################### batch time #####################################
1301.011085510254ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1312])
##################################### peak mem #####################################
9889.0869140625MB
##################################### batch time #####################################
1263.4356021881104ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.798828125MB
##################################### batch time #####################################
1399.1093635559082ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 1024])
##################################### peak mem #####################################
7912.51025390625MB
##################################### batch time #####################################
1170.7465648651123ms
##################################### input shape #####################################
torch.Size([6, 3, 1024, 864])
##################################### peak mem #####################################
8440.94677734375MB
##################################### batch time #####################################
1116.5108680725098ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 800])
##################################### peak mem #####################################
8317.71435546875MB
##################################### batch time #####################################
2558.884382247925ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1152])
##################################### peak mem #####################################
8439.7392578125MB
##################################### batch time #####################################
2684.0665340423584ms
##################################### input shape #####################################
torch.Size([6, 3, 1088, 704])
##################################### peak mem #####################################
8027.515625MB
##################################### batch time #####################################
1803.490400314331ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 864])
##################################### peak mem #####################################
8109.15771484375MB
##################################### batch time #####################################
2272.073984146118ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1344])
##################################### peak mem #####################################
9737.64111328125MB
##################################### batch time #####################################
4676.56683921814ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 1216])
##################################### peak mem #####################################
10239.97021484375MB
##################################### batch time #####################################
1462.463140487671ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 928])
##################################### peak mem #####################################
8044.66064453125MB
##################################### batch time #####################################
1403.9957523345947ms
##################################### input shape #####################################
torch.Size([6, 3, 1056, 800])
##################################### peak mem #####################################
8090.4091796875MB
##################################### batch time #####################################
1181.1649799346924ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 736])
##################################### peak mem #####################################
7999.69384765625MB
##################################### batch time #####################################
1155.5635929107666ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1024])
##################################### peak mem #####################################
7576.70458984375MB
##################################### batch time #####################################
1009.7427368164062ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.26318359375MB
##################################### batch time #####################################
1286.7066860198975ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1344])
##################################### peak mem #####################################
9737.697265625MB
##################################### batch time #####################################
1452.4214267730713ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1056])
##################################### peak mem #####################################
7792.25537109375MB
##################################### batch time #####################################
1417.6075458526611ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1312])
##################################### peak mem #####################################
9889.0869140625MB
##################################### batch time #####################################
1259.7324848175049ms
##################################### input shape #####################################
torch.Size([6, 3, 672, 896])
##################################### peak mem #####################################
8098.80517578125MB
##################################### batch time #####################################
1272.3472118377686ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.49072265625MB
##################################### batch time #####################################
1117.0377731323242ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8767.49072265625MB
##################################### batch time #####################################
1327.439546585083ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 1120])
##################################### peak mem #####################################
8226.08642578125MB
##################################### batch time #####################################
1318.0224895477295ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
##################################### peak mem #####################################
8768.0732421875MB
##################################### batch time #####################################
1251.3422966003418ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 864])
##################################### peak mem #####################################
7711.34423828125MB
##################################### batch time #####################################
1273.9648818969727ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1197.4220275878906ms
##################################### input shape #####################################
torch.Size([6, 3, 768, 928])
##################################### peak mem #####################################
8043.0498046875MB
##################################### batch time #####################################
1078.9408683776855ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9214.994140625MB
##################################### batch time #####################################
1143.2795524597168ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 736])
##################################### peak mem #####################################
8090.1181640625MB
##################################### batch time #####################################
1189.4943714141846ms
##################################### input shape #####################################
torch.Size([6, 3, 896, 832])
##################################### peak mem #####################################
7835.4296875MB
##################################### batch time #####################################
974.7700691223145ms
##################################### input shape #####################################
torch.Size([6, 3, 832, 1088])
##################################### peak mem #####################################
8624.16552734375MB
##################################### batch time #####################################
1201.21169090271ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1152])
2023-02-19 11:04:16,986 - mmdet - INFO - Epoch [1][200/19545]	lr: 3.986e-03, eta: 9:38:46, time: 1.478, data_time: 0.552, memory: 9280, loss_cls: 1.1691, loss_bbox: 0.7185, loss: 1.8876
##################################### peak mem #####################################
8767.83740234375MB
##################################### batch time #####################################
1392.625331878662ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1088])
##################################### peak mem #####################################
8317.818359375MB
##################################### batch time #####################################
1347.3849296569824ms
##################################### input shape #####################################
torch.Size([6, 3, 1216, 800])
##################################### peak mem #####################################
9215.06982421875MB
##################################### batch time #####################################
1339.134931564331ms
##################################### input shape #####################################
torch.Size([6, 3, 736, 736])
##################################### peak mem #####################################
8094.75244140625MB
##################################### batch time #####################################
1191.6589736938477ms
##################################### input shape #####################################
torch.Size([6, 3, 864, 1088])
##################################### peak mem #####################################
8930.08740234375MB
##################################### batch time #####################################
1027.0321369171143ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 992])
##################################### peak mem #####################################
7640.859375MB
##################################### batch time #####################################
1307.9464435577393ms
##################################### input shape #####################################
torch.Size([6, 3, 800, 1216])
##################################### peak mem #####################################
9215.94873046875MB
##################################### batch time #####################################
1173.8975048065186ms
##################################### input shape #####################################
torch.Size([6, 3, 928, 1056])
##################################### peak mem #####################################
9280.7783203125MB
##################################### batch time #####################################
1336.3878726959229ms
##################################### input shape #####################################
torch.Size([6, 3, 960, 1216])
##################################### peak mem #####################################
10923.19140625MB
##################################### batch time #####################################
1362.9112243652344ms
Traceback (most recent call last):
  File "/workspace/mimose-mmdet/tools/train.py", line 192, in <module>
    main()
  File "/workspace/mimose-mmdet/tools/train.py", line 181, in main
    train_detector(
  File "/workspace/mimose-mmdet/mmdet/apis/train.py", line 191, in train_detector
    runner.run(data_loaders, cfg.workflow)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 136, in run
    epoch_runner(data_loaders[i], **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 53, in train
    self.run_iter(data_batch, train_mode=True, **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/epoch_based_runner.py", line 31, in run_iter
    outputs = self.model.train_step(data_batch, self.optimizer,
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/parallel/data_parallel.py", line 77, in train_step
    return self.module.train_step(*inputs[0], **kwargs[0])
  File "/workspace/mimose-mmdet/mmdet/models/detectors/base.py", line 251, in train_step
    losses = self(**data)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/fp16_utils.py", line 119, in new_func
    return old_func(*args, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/detectors/base.py", line 181, in forward
    return self.forward_train(img, img_metas, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/detectors/single_stage.py", line 159, in forward_train
    losses = self.bbox_head.forward_train(x, img_metas, gt_bboxes,
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/base_dense_head.py", line 54, in forward_train
    losses = self.loss(*loss_inputs, gt_bboxes_ignore=gt_bboxes_ignore)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/runner/fp16_utils.py", line 208, in new_func
    return old_func(*args, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/anchor_head.py", line 483, in loss
    losses_cls, losses_bbox = multi_apply(
  File "/workspace/mimose-mmdet/mmdet/core/utils/misc.py", line 29, in multi_apply
    return tuple(map(list, zip(*map_results)))
  File "/workspace/mimose-mmdet/mmdet/models/dense_heads/anchor_head.py", line 406, in loss_single
    loss_cls = self.loss_cls(
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspace/mimose-mmdet/mmdet/models/losses/focal_loss.py", line 170, in forward
    loss_cls = self.loss_weight * calculate_loss_func(
  File "/workspace/mimose-mmdet/mmdet/models/losses/focal_loss.py", line 101, in sigmoid_focal_loss
    loss = weight_reduce_loss(loss, weight, reduction, avg_factor)
  File "/opt/conda/envs/mimose/lib/python3.9/site-packages/mmcv/utils/parrots_jit.py", line 22, in wrapper_inner
    return func(*args, **kargs)
  File "/workspace/mimose-mmdet/mmdet/models/losses/utils.py", line 42, in weight_reduce_loss
    loss = loss * weight
RuntimeError: CUDA out of memory. Tried to allocate 352.00 MiB (GPU 0; 31.75 GiB total capacity; 12.00 GiB already allocated; 17.44 GiB free; 13.00 GiB allowed; 12.89 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
